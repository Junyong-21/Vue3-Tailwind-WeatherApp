import{o as a,c,a as s,t as p,r as _,w as k,u as g,F as y,b,d as u,e as v,f as $,v as C,g as S,h as w,S as V}from"./index-e5134283.js";import{a as q,A as x}from"./AnimatedPlaceholder-bf01c4c6.js";const T={class:"flex py-6 px-3 bg-weather-secondary rounded-md shadow-md cursor-pointer"},E={class:"flex flex-col flex-1"},B={class:"text-3xl"},D={class:"flex flex-col gap-2"},I={class:"text-3xl self-end"},L={class:"flex gap-2"},N={class:"text-xs"},A={__name:"cityCard",props:{city:{type:Object,default:()=>{}}},setup(h){const o=h;return console.log(o.city),(r,i)=>(a(),c("div",T,[s("div",E,[s("h2",B,p(o.city.city),1),s("h3",null,p(o.city.state),1)]),s("div",D,[s("p",I,p(o.city.weather.now.temp)+"℃ ",1),s("div",L,[s("span",N," 体感温度： "+p(o.city.weather.now.feelsLike)+"℃ ",1)])])]))}},P={key:0},j={__name:"cityList",async setup(h){let o,r;const i=_([]),d=async()=>{if(localStorage.getItem("savedCities")){i.value=JSON.parse(localStorage.getItem("savedCities"));let l=[];i.value.forEach(e=>{l.push(q.get(`https://devapi.qweather.com/v7/weather/now?location=${e.coords.lng},${e.coords.lat}&key=c64bebdc3d8047d29bb483594207ce62`))});const t=await Promise.all(l);await new Promise(e=>setTimeout(e,1e3)),t.forEach((e,n)=>{i.value[n].weather=e.data})}};[o,r]=k(()=>d()),await o,r();const m=g(),f=l=>{m.push({name:"CityView",params:{state:l.state,city:l.city},query:{id:l.id,lat:l.coords.lat,lon:l.coords.lng}})};return(l,t)=>(a(),c(y,null,[(a(!0),c(y,null,b(i.value,e=>(a(),c("div",{key:e.id},[u(A,{city:e,onClick:n=>f(e)},null,8,["city","onClick"])]))),128)),i.value.length===0?(a(),c("p",P,"未添加位置。要开始跟踪位置，请在上面的搜索框中搜索。")):v("",!0)],64))}},F={class:"flex py-6 px-3 bg-weather-secondary rounded-md shadow-md cursor-pointer"},O={class:"flex flex-col flex-1 gap-2"},U={class:"flex flex-col items-end flex-1 gap-2"},H={__name:"cityCardSkeleton",setup(h){return(o,r)=>(a(),c("div",F,[s("div",O,[u(x,{class:"max-w-[50%]"}),u(x,{class:"max-w-[40%]"})]),s("div",U,[u(x,{class:"max-w-[50px] w-full"}),u(x,{class:"max-w-[75px] w-full"})])]))}},J={class:"container text-white"},M={class:"pt-4 mb-8 relative"},Q={key:0,class:"absolute bg-weather-secondary text-white w-full shadow-md py-2 px-1 top-[66px]"},R={key:0},z=["onClick"],G={class:"flex flex-col gap-4"},Y={__name:"HomeView",setup(h){const o=g(),r=_(""),i=_(null),d=_(null),m=_(null),f=()=>{clearTimeout(i.value),i.value=setTimeout(()=>{if(r.value!="")try{fetch(`https://geoapi.qweather.com/v2/city/lookup?location=${r.value}&key=c64bebdc3d8047d29bb483594207ce62`).then(function(t){return t.json()}).then(function(t){d.value=t.location})}catch{m.value=!0}d.value=null},300)},l=t=>{const e=t.adm2,n=t.name;o.push({name:"CityView",params:{state:n,city:e},query:{lat:t.lat,lon:t.lon,locationID:t.id,preview:!0}})};return(t,e)=>(a(),c("main",J,[s("div",M,[$(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n),onInput:f,placeholder:"搜索城市或者省份",class:"py-2 px-1 w-full bg-transparent border-b focus:border-weather-secondary focus:outline-none focus:shadow-[0px_1px_0_0_#004E71]"},null,544),[[C,r.value]]),d.value?(a(),c("ul",Q,[m.value?(a(),c("p",R,"出现了点问题，请再试一次")):v("",!0),(a(!0),c(y,null,b(d.value,n=>(a(),c("li",{key:n.id,class:"py-2 cursor-pointer",onClick:K=>l(n)},p(n.name),9,z))),128))])):v("",!0)]),s("div",G,[(a(),S(V,null,{fallback:w(()=>[s("div",null,[u(H)])]),default:w(()=>[u(j)]),_:1}))])]))}};export{Y as default};
